{"version":3,"file":"rename-folder.action-BHH2BuQx.js","sources":["../../../Client/src/entity-actions/rename-folder.action.ts"],"sourcesContent":["/**\r\n * Rename Folder Entity Action\r\n *\r\n * Opens a modal dialog to rename a folder.\r\n * Skills used: umbraco-entity-actions, umbraco-modals, umbraco-notifications\r\n */\r\n\r\nimport { UmbEntityActionBase, UmbRequestReloadStructureForEntityEvent } from \"@umbraco-cms/backoffice/entity-action\";\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from \"@umbraco-cms/backoffice/modal\";\r\nimport { UMB_NOTIFICATION_CONTEXT } from \"@umbraco-cms/backoffice/notification\";\r\nimport { NoteswikiService } from \"../api/index.js\";\r\nimport { UMB_ACTION_EVENT_CONTEXT } from \"@umbraco-cms/backoffice/action\";\r\nimport { FOLDER_NAME_MODAL } from \"./rename-folder.modal-token.js\";\r\n\r\nexport class RenameFolderEntityAction extends UmbEntityActionBase<never> {\r\n  override async execute() {\r\n    const unique = this.args.unique;\r\n    if (!unique) return;\r\n\r\n    // Get the current folder data\r\n    let currentName = \"\";\r\n    try {\r\n      const response = await NoteswikiService.getFolder({\r\n        path: { id: unique },\r\n      });\r\n      currentName = response.data.name;\r\n    } catch {\r\n      console.error(\"Failed to load folder\");\r\n      return;\r\n    }\r\n\r\n    // Open rename modal\r\n    const modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n    if (!modalManager) return;\r\n\r\n    const modal = modalManager.open(this, FOLDER_NAME_MODAL, {\r\n      data: {\r\n        headline: \"Rename Folder\",\r\n        currentName,\r\n        confirmLabel: \"Rename\",\r\n      },\r\n    });\r\n\r\n    const result = await modal.onSubmit().catch(() => undefined);\r\n\r\n    if (!result?.name) return;\r\n\r\n    try {\r\n      // Call API to rename\r\n      await NoteswikiService.updateFolder({\r\n        path: { id: unique },\r\n        body: {\r\n          name: result.name,\r\n        },\r\n      });\r\n\r\n      // Show success notification\r\n      const notificationContext = await this.getContext(UMB_NOTIFICATION_CONTEXT);\r\n      notificationContext?.peek(\"positive\", {\r\n        data: {\r\n          headline: \"Folder renamed\",\r\n          message: `Folder has been renamed to \"${result.name}\".`,\r\n        },\r\n      });\r\n\r\n      // Refresh tree by dispatching structure reload event\r\n      const eventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\r\n      if (eventContext) {\r\n        eventContext.dispatchEvent(\r\n          new UmbRequestReloadStructureForEntityEvent({\r\n            entityType: this.args.entityType,\r\n            unique: unique,\r\n          })\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error renaming folder:\", error);\r\n\r\n      const notificationContext = await this.getContext(UMB_NOTIFICATION_CONTEXT);\r\n      notificationContext?.peek(\"danger\", {\r\n        data: {\r\n          headline: \"Error\",\r\n          message: \"Failed to rename the folder. Please try again.\",\r\n        },\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport default RenameFolderEntityAction;\r\n"],"names":["RenameFolderEntityAction","UmbEntityActionBase","unique","currentName","NoteswikiService","modalManager","UMB_MODAL_MANAGER_CONTEXT","result","FOLDER_NAME_MODAL","notificationContext","UMB_NOTIFICATION_CONTEXT","eventContext","UMB_ACTION_EVENT_CONTEXT","UmbRequestReloadStructureForEntityEvent","error"],"mappings":";;;;;;;AAcO,MAAMA,UAAiCC,EAA2B;AAAA,EACvE,MAAe,UAAU;AACvB,UAAMC,IAAS,KAAK,KAAK;AACzB,QAAI,CAACA,EAAQ;AAGb,QAAIC,IAAc;AAClB,QAAI;AAIF,MAAAA,KAHiB,MAAMC,EAAiB,UAAU;AAAA,QAChD,MAAM,EAAE,IAAIF,EAAA;AAAA,MAAO,CACpB,GACsB,KAAK;AAAA,IAC9B,QAAQ;AACN,cAAQ,MAAM,uBAAuB;AACrC;AAAA,IACF;AAGA,UAAMG,IAAe,MAAM,KAAK,WAAWC,CAAyB;AACpE,QAAI,CAACD,EAAc;AAUnB,UAAME,IAAS,MARDF,EAAa,KAAK,MAAMG,GAAmB;AAAA,MACvD,MAAM;AAAA,QACJ,UAAU;AAAA,QACV,aAAAL;AAAA,QACA,cAAc;AAAA,MAAA;AAAA,IAChB,CACD,EAE0B,WAAW,MAAM,MAAA;AAAA,KAAe;AAE3D,QAAKI,KAAA,QAAAA,EAAQ;AAEb,UAAI;AAEF,cAAMH,EAAiB,aAAa;AAAA,UAClC,MAAM,EAAE,IAAIF,EAAA;AAAA,UACZ,MAAM;AAAA,YACJ,MAAMK,EAAO;AAAA,UAAA;AAAA,QACf,CACD;AAGD,cAAME,IAAsB,MAAM,KAAK,WAAWC,CAAwB;AAC1E,QAAAD,KAAA,QAAAA,EAAqB,KAAK,YAAY;AAAA,UACpC,MAAM;AAAA,YACJ,UAAU;AAAA,YACV,SAAS,+BAA+BF,EAAO,IAAI;AAAA,UAAA;AAAA,QACrD;AAIF,cAAMI,IAAe,MAAM,KAAK,WAAWC,CAAwB;AACnE,QAAID,KACFA,EAAa;AAAA,UACX,IAAIE,EAAwC;AAAA,YAC1C,YAAY,KAAK,KAAK;AAAA,YACtB,QAAAX;AAAA,UAAA,CACD;AAAA,QAAA;AAAA,MAGP,SAASY,GAAO;AACd,gBAAQ,MAAM,0BAA0BA,CAAK;AAE7C,cAAML,IAAsB,MAAM,KAAK,WAAWC,CAAwB;AAC1E,QAAAD,KAAA,QAAAA,EAAqB,KAAK,UAAU;AAAA,UAClC,MAAM;AAAA,YACJ,UAAU;AAAA,YACV,SAAS;AAAA,UAAA;AAAA,QACX;AAAA,MAEJ;AAAA,EACF;AACF;"}