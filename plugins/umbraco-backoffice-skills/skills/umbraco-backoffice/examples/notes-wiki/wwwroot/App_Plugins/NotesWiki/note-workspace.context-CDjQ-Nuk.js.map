{"version":3,"file":"note-workspace.context-CDjQ-Nuk.js","sources":["../../../Client/src/workspace/note/note-workspace-editor.element.ts","../../../Client/src/workspace/note/note-workspace.context.ts"],"sourcesContent":["/**\r\n * Note Workspace Editor Element\r\n *\r\n * The main editor component for the Note workspace.\r\n * Contains the workspace chrome (header, footer) and renders workspace views.\r\n *\r\n * Skills used: umbraco-workspace, umbraco-umbraco-element, umbraco-context-api\r\n */\r\n\r\nimport { NOTE_WORKSPACE_CONTEXT } from \"./note-workspace.context-token.js\";\r\nimport { css, html, customElement, state } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbLitElement } from \"@umbraco-cms/backoffice/lit-element\";\r\nimport { NOTES_NOTE_WORKSPACE_ALIAS } from \"../constants.js\";\r\n\r\n@customElement(\"notes-note-workspace-editor\")\r\nexport class NoteWorkspaceEditorElement extends UmbLitElement {\r\n  #workspaceContext?: typeof NOTE_WORKSPACE_CONTEXT.TYPE;\r\n\r\n  @state()\r\n  private _title = \"\";\r\n\r\n  @state()\r\n  private _icon = \"icon-notepad\";\r\n\r\n  @state()\r\n  private _isNew = false;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.consumeContext(NOTE_WORKSPACE_CONTEXT, (instance) => {\r\n      this.#workspaceContext = instance;\r\n      this.#observeData();\r\n    });\r\n  }\r\n\r\n  #observeData() {\r\n    if (!this.#workspaceContext) return;\r\n\r\n    this.observe(this.#workspaceContext.title, (title) => {\r\n      this._title = title || \"\";\r\n    });\r\n\r\n    this.observe(this.#workspaceContext.icon, (icon) => {\r\n      this._icon = icon || \"icon-notepad\";\r\n    });\r\n\r\n    this.observe(this.#workspaceContext.isNew, (isNew) => {\r\n      this._isNew = isNew ?? false;\r\n    });\r\n  }\r\n\r\n  override render() {\r\n    const displayTitle = this._title || (this._isNew ? \"New Note\" : \"Note\");\r\n\r\n    return html`\r\n      <umb-workspace-editor alias=${NOTES_NOTE_WORKSPACE_ALIAS}>\r\n        <div id=\"header\" slot=\"header\">\r\n          <uui-icon name=${this._icon}></uui-icon>\r\n          <span class=\"title\">${displayTitle}</span>\r\n          ${this._isNew ? html`<uui-tag color=\"positive\">New</uui-tag>` : \"\"}\r\n        </div>\r\n      </umb-workspace-editor>\r\n    `;\r\n  }\r\n\r\n  static override readonly styles = [\r\n    css`\r\n      :host {\r\n        display: block;\r\n        width: 100%;\r\n        height: 100%;\r\n      }\r\n\r\n      #header {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: var(--uui-size-space-3);\r\n        font-size: 1.2rem;\r\n        font-weight: bold;\r\n      }\r\n\r\n      uui-icon {\r\n        font-size: 1.5rem;\r\n      }\r\n\r\n      .title {\r\n        flex: 1;\r\n      }\r\n    `,\r\n  ];\r\n}\r\n\r\nexport default NoteWorkspaceEditorElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"notes-note-workspace-editor\": NoteWorkspaceEditorElement;\r\n  }\r\n}\r\n","/**\r\n * @fileoverview Note Workspace Context\r\n *\r\n * The workspace context is the central coordinator for note editing operations.\r\n * It manages state, handles API communication, and provides reactive data\r\n * for UI components to bind to.\r\n *\r\n * **Workspace Context Pattern:**\r\n *\r\n * In Umbraco, workspaces follow a pattern where:\r\n * 1. **Context** - Manages state and business logic (this file)\r\n * 2. **Editor Element** - Renders the workspace chrome (header, footer)\r\n * 3. **View Elements** - Render content within workspace tabs\r\n *\r\n * ```\r\n * Workspace Context (state + logic)\r\n *         │\r\n *         ├─── Editor Element (chrome)\r\n *         │         │\r\n *         │         └─── Workspace Views (content tabs)\r\n *         │\r\n *         └─── Provided via UMB_WORKSPACE_CONTEXT\r\n * ```\r\n *\r\n * **Key Responsibilities:**\r\n *\r\n * 1. **State Management**: Observable properties for reactive UI\r\n * 2. **Data Loading**: Fetch note from API when workspace opens\r\n * 3. **Data Saving**: Submit changes to API when Save is clicked\r\n * 4. **Routing**: Define URL patterns for edit/create modes\r\n * 5. **Tree Updates**: Notify tree to refresh after changes\r\n *\r\n * **IMPORTANT: UmbSubmittableWorkspaceContextBase**\r\n *\r\n * This context extends `UmbSubmittableWorkspaceContextBase` which:\r\n * - Enables the Save button in the workspace\r\n * - Provides `requestSubmit()` method for workspace actions\r\n * - Tracks dirty state automatically\r\n * - Manages the `isNew` flag for create vs edit mode\r\n *\r\n * Without extending this base class, the Save button won't appear!\r\n *\r\n * Skills demonstrated: umbraco-workspace, umbraco-context-api, umbraco-state-management\r\n */\r\n\r\nimport { NOTES_NOTE_WORKSPACE_ALIAS } from \"../constants.js\";\r\nimport { NoteWorkspaceEditorElement } from \"./note-workspace-editor.element.js\";\r\nimport {\r\n  UmbSubmittableWorkspaceContextBase,\r\n  UmbWorkspaceIsNewRedirectController,\r\n} from \"@umbraco-cms/backoffice/workspace\";\r\nimport { UmbStringState, UmbArrayState } from \"@umbraco-cms/backoffice/observable-api\";\r\nimport type { UmbControllerHost } from \"@umbraco-cms/backoffice/controller-api\";\r\nimport { NOTES_NOTE_ENTITY_TYPE, NOTES_FOLDER_ENTITY_TYPE, NOTES_ROOT_ENTITY_TYPE } from \"../../constants.js\";\r\nimport { NoteswikiService } from \"../../api/index.js\";\r\nimport { UMB_NOTIFICATION_CONTEXT } from \"@umbraco-cms/backoffice/notification\";\r\nimport { UMB_ACTION_EVENT_CONTEXT } from \"@umbraco-cms/backoffice/action\";\r\nimport { UmbRequestReloadChildrenOfEntityEvent } from \"@umbraco-cms/backoffice/entity-action\";\r\n\r\n/**\r\n * Data model for note content in the workspace.\r\n *\r\n * This interface represents the shape of note data as managed by the\r\n * workspace context. It's used for type safety when getting/setting data.\r\n */\r\nexport interface NoteWorkspaceData {\r\n  /** Unique identifier (GUID) for the note */\r\n  unique: string;\r\n  /** Note title displayed in the header and tree */\r\n  title: string;\r\n  /** Markdown content of the note */\r\n  content: string;\r\n  /** Tags for categorization */\r\n  tags: string[];\r\n  /** Parent folder ID, or null if at root */\r\n  parentUnique: string | null;\r\n}\r\n\r\n/**\r\n * Workspace context for editing notes.\r\n *\r\n * This is the brain of the note workspace. It:\r\n * - Manages all note data as observable state\r\n * - Handles loading and saving via the API\r\n * - Defines workspace routes for edit/create modes\r\n * - Notifies users of success/failure via toasts\r\n * - Triggers tree updates after saves\r\n *\r\n * **Observable State Pattern:**\r\n *\r\n * Each property uses Umbraco's `UmbStringState` or `UmbArrayState` which:\r\n * - Stores the current value\r\n * - Provides an RxJS observable for reactive updates\r\n * - Enables UI components to subscribe to changes\r\n *\r\n * ```typescript\r\n * // Private state (mutable)\r\n * #title = new UmbStringState(\"\");\r\n *\r\n * // Public observable (read-only subscription)\r\n * readonly title = this.#title.asObservable();\r\n *\r\n * // Components subscribe:\r\n * this.observe(context.title, (title) => this._title = title);\r\n * ```\r\n *\r\n * **Routing:**\r\n *\r\n * The context defines two routes:\r\n * - `edit/:unique` - Edit an existing note\r\n * - `create/parent/:parentEntityType/:parentUnique` - Create a new note\r\n *\r\n * @extends UmbSubmittableWorkspaceContextBase<NoteWorkspaceData>\r\n *\r\n * @example\r\n * // Consuming the context in a view component\r\n * this.consumeContext(NOTE_WORKSPACE_CONTEXT, (context) => {\r\n *   // Subscribe to title changes\r\n *   this.observe(context.title, (title) => {\r\n *     this._title = title;\r\n *   });\r\n *\r\n *   // Update the title\r\n *   context.setTitle(\"New Title\");\r\n * });\r\n */\r\nexport class NoteWorkspaceContext extends UmbSubmittableWorkspaceContextBase<NoteWorkspaceData> {\r\n  // ===========================================================================\r\n  // OBSERVABLE STATE\r\n  // Private state objects with public observables for reactive UI binding\r\n  // ===========================================================================\r\n\r\n  /** Private state for unique ID */\r\n  #unique = new UmbStringState(undefined);\r\n  /** Observable unique ID - subscribe to track the current note */\r\n  readonly unique = this.#unique.asObservable();\r\n\r\n  /** Private state for title */\r\n  #title = new UmbStringState(\"\");\r\n  /** Observable title - subscribe to display/edit the note title */\r\n  readonly title = this.#title.asObservable();\r\n\r\n  /** Private state for content */\r\n  #content = new UmbStringState(\"\");\r\n  /** Observable content - subscribe to display/edit markdown content */\r\n  readonly content = this.#content.asObservable();\r\n\r\n  /** Private state for tags array */\r\n  #tags = new UmbArrayState<string>([], (x) => x);\r\n  /** Observable tags - subscribe to display/edit tags list */\r\n  readonly tags = this.#tags.asObservable();\r\n\r\n  /** Private state for icon */\r\n  #icon = new UmbStringState(\"icon-notepad\");\r\n  /** Observable icon - subscribe for header display */\r\n  readonly icon = this.#icon.asObservable();\r\n\r\n  /** Private state for parent folder ID */\r\n  #parentUnique = new UmbStringState(undefined);\r\n  /** Observable parent ID - null means root level */\r\n  readonly parentUnique = this.#parentUnique.asObservable();\r\n\r\n  // ===========================================================================\r\n  // METADATA STATE (Read-only - set by API, not editable by user)\r\n  // ===========================================================================\r\n\r\n  /** Private state for creation date */\r\n  #createdDate = new UmbStringState(undefined);\r\n  /** Observable creation date (ISO 8601 string) */\r\n  readonly createdDate = this.#createdDate.asObservable();\r\n\r\n  /** Private state for modification date */\r\n  #modifiedDate = new UmbStringState(undefined);\r\n  /** Observable modification date (ISO 8601 string) */\r\n  readonly modifiedDate = this.#modifiedDate.asObservable();\r\n\r\n  /** Private state for creator username */\r\n  #createdBy = new UmbStringState(undefined);\r\n  /** Observable creator username */\r\n  readonly createdBy = this.#createdBy.asObservable();\r\n\r\n  /** Private state for last modifier username */\r\n  #modifiedBy = new UmbStringState(undefined);\r\n  /** Observable last modifier username */\r\n  readonly modifiedBy = this.#modifiedBy.asObservable();\r\n\r\n  // ===========================================================================\r\n  // CONSUMED CONTEXTS\r\n  // ===========================================================================\r\n\r\n  /** Notification context for displaying toast messages */\r\n  #notificationContext?: typeof UMB_NOTIFICATION_CONTEXT.TYPE;\r\n\r\n  /**\r\n   * Creates a new note workspace context.\r\n   *\r\n   * Sets up:\r\n   * - Route definitions for edit/create modes\r\n   * - Notification context consumption for toasts\r\n   *\r\n   * **Important:** Do NOT call `provideContext` here.\r\n   * `UmbSubmittableWorkspaceContextBase` already provides `UMB_WORKSPACE_CONTEXT`.\r\n   * Our `NOTE_WORKSPACE_CONTEXT` token uses \"UmbWorkspaceContext\" as its alias,\r\n   * which matches the base class provision.\r\n   *\r\n   * @param {UmbControllerHost} host - The controller host (typically the workspace element)\r\n   */\r\n  constructor(host: UmbControllerHost) {\r\n    super(host, NOTES_NOTE_WORKSPACE_ALIAS);\r\n\r\n    // NOTE: Do NOT call provideContext here - UmbSubmittableWorkspaceContextBase\r\n    // already provides UMB_WORKSPACE_CONTEXT. The NOTE_WORKSPACE_CONTEXT token\r\n    // uses \"UmbWorkspaceContext\" as its alias which matches the base class provision.\r\n\r\n    // Consume notification context for success/error toast messages\r\n    this.consumeContext(UMB_NOTIFICATION_CONTEXT, (context) => {\r\n      this.#notificationContext = context;\r\n    });\r\n\r\n    // Define workspace routes\r\n    // These determine what component renders based on the URL\r\n    this.routes.setRoutes([\r\n      {\r\n        // Route: Edit an existing note\r\n        // URL: /section/notes/workspace/notes-note/edit/{guid}\r\n        path: \"edit/:unique\",\r\n        component: NoteWorkspaceEditorElement,\r\n        setup: (_component, info) => {\r\n          const unique = info.match.params.unique;\r\n          this.load(unique);\r\n        },\r\n      },\r\n      {\r\n        // Route: Create a new note\r\n        // URL: /section/notes/workspace/notes-note/create/parent/{parentEntityType}/{parentId}\r\n        path: \"create/parent/:parentEntityType/:parentUnique\",\r\n        component: NoteWorkspaceEditorElement,\r\n        setup: (_component, info) => {\r\n          const parentUnique =\r\n            info.match.params.parentUnique === \"null\"\r\n              ? null\r\n              : info.match.params.parentUnique;\r\n          this.createScaffold(parentUnique);\r\n\r\n          // After saving a new note, redirect from /create to /edit URL\r\n          // This prevents issues with the browser back button\r\n          new UmbWorkspaceIsNewRedirectController(\r\n            this,\r\n            this,\r\n            this.getHostElement().shadowRoot!.querySelector(\"umb-router-slot\")!\r\n          );\r\n        },\r\n      },\r\n    ]);\r\n  }\r\n\r\n  // ===========================================================================\r\n  // DATA LOADING\r\n  // ===========================================================================\r\n\r\n  /**\r\n   * Loads an existing note from the API.\r\n   *\r\n   * Called by the edit route when the workspace opens.\r\n   * Fetches note data and populates all state properties.\r\n   *\r\n   * @param {string} unique - The unique ID (GUID) of the note to load\r\n   *\r\n   * @example\r\n   * // Called automatically by route setup, but can be called manually:\r\n   * await context.load(\"abc-123-def-456\");\r\n   */\r\n  async load(unique: string) {\r\n    this.#unique.setValue(unique);\r\n    this.setIsNew(false);\r\n\r\n    try {\r\n      const response = await NoteswikiService.getNote({\r\n        path: { id: unique },\r\n      });\r\n\r\n      const data = response.data;\r\n      this.#title.setValue(data.title);\r\n      this.#content.setValue(data.content);\r\n      this.#tags.setValue(data.tags || []);\r\n      this.#parentUnique.setValue(data.parentUnique ?? undefined);\r\n      this.#createdDate.setValue(data.createdDate);\r\n      this.#modifiedDate.setValue(data.modifiedDate);\r\n      this.#createdBy.setValue(data.createdBy);\r\n      this.#modifiedBy.setValue(data.modifiedBy);\r\n    } catch (error) {\r\n      console.error(\"Error loading note:\", error);\r\n      // Set default values on error so UI doesn't break\r\n      this.#title.setValue(\"Error loading note\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Creates a scaffold for a new note.\r\n   *\r\n   * Called by the create route when creating a new note.\r\n   * Generates a new unique ID and initializes all state to defaults.\r\n   *\r\n   * @param {string | null} parentUnique - Parent folder ID, or null for root level\r\n   *\r\n   * @example\r\n   * // Create note in folder\r\n   * context.createScaffold(\"folder-abc-123\");\r\n   *\r\n   * // Create note at root\r\n   * context.createScaffold(null);\r\n   */\r\n  createScaffold(parentUnique: string | null) {\r\n    // Generate a new UUID for the note\r\n    const newUnique = crypto.randomUUID();\r\n    this.#unique.setValue(newUnique);\r\n    this.setIsNew(true);\r\n    this.#parentUnique.setValue(parentUnique ?? undefined);\r\n\r\n    // Initialize editable fields to empty\r\n    this.#title.setValue(\"\");\r\n    this.#content.setValue(\"\");\r\n    this.#tags.setValue([]);\r\n\r\n    // Clear metadata (will be set by server on save)\r\n    this.#createdDate.setValue(undefined);\r\n    this.#modifiedDate.setValue(undefined);\r\n    this.#createdBy.setValue(undefined);\r\n    this.#modifiedBy.setValue(undefined);\r\n  }\r\n\r\n  // ===========================================================================\r\n  // DATA SAVING\r\n  // ===========================================================================\r\n\r\n  /**\r\n   * Saves the note to the API.\r\n   *\r\n   * **IMPORTANT:** This is the `submit` method required by `UmbSubmittableWorkspaceContextBase`.\r\n   * It's called automatically when the user clicks the Save button in the workspace header.\r\n   *\r\n   * The method:\r\n   * 1. Validates that we have a unique ID\r\n   * 2. Creates or updates the note via API\r\n   * 3. Shows success/error notification\r\n   * 4. Triggers tree refresh to show new/updated item\r\n   *\r\n   * @returns {Promise<void>} Resolves on success, throws on failure\r\n   * @throws {Error} If unique ID is missing or API call fails\r\n   *\r\n   * @protected - Called by base class, not directly by consumers\r\n   */\r\n  protected async submit(): Promise<void> {\r\n    const unique = this.#unique.getValue();\r\n    const isNew = this.getIsNew();\r\n\r\n    if (!unique) {\r\n      throw new Error(\"Cannot save: no unique identifier\");\r\n    }\r\n\r\n    try {\r\n      if (isNew) {\r\n        await NoteswikiService.createNote({\r\n          body: {\r\n            unique,\r\n            parentUnique: this.#parentUnique.getValue() || null,\r\n            title: this.#title.getValue(),\r\n            content: this.#content.getValue(),\r\n            tags: this.#tags.getValue(),\r\n          },\r\n        });\r\n      } else {\r\n        await NoteswikiService.updateNote({\r\n          path: { id: unique },\r\n          body: {\r\n            title: this.#title.getValue(),\r\n            content: this.#content.getValue(),\r\n            tags: this.#tags.getValue(),\r\n          },\r\n        });\r\n      }\r\n\r\n      this.setIsNew(false);\r\n\r\n      // Show success notification\r\n      this.#notificationContext?.peek(\"positive\", {\r\n        data: {\r\n          headline: \"Note saved\",\r\n          message: `\"${this.#title.getValue()}\" has been saved successfully.`,\r\n        },\r\n      });\r\n\r\n      // Request tree to reload the parent's children\r\n      const eventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\r\n      if (eventContext) {\r\n        const parentUnique = this.#parentUnique.getValue();\r\n        const event = new UmbRequestReloadChildrenOfEntityEvent({\r\n          entityType: parentUnique ? NOTES_FOLDER_ENTITY_TYPE : NOTES_ROOT_ENTITY_TYPE,\r\n          unique: parentUnique ?? null,\r\n        });\r\n        eventContext.dispatchEvent(event);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error saving note:\", error);\r\n\r\n      // Show error notification\r\n      this.#notificationContext?.peek(\"danger\", {\r\n        data: {\r\n          headline: \"Error saving note\",\r\n          message: \"An error occurred while saving the note. Please try again.\",\r\n        },\r\n      });\r\n\r\n      throw error; // Re-throw so workspace action knows it failed\r\n    }\r\n  }\r\n\r\n  // ===========================================================================\r\n  // GETTERS - Required by UmbSubmittableWorkspaceContextBase\r\n  // These methods are called by the base class and workspace system\r\n  // ===========================================================================\r\n\r\n  /**\r\n   * Gets the unique identifier of the current note.\r\n   *\r\n   * Required by `UmbSubmittableWorkspaceContextBase`.\r\n   *\r\n   * @returns {string | undefined} The note's unique ID, or undefined if not set\r\n   */\r\n  getUnique() {\r\n    return this.#unique.getValue();\r\n  }\r\n\r\n  /**\r\n   * Gets the entity type for this workspace.\r\n   *\r\n   * Required by `UmbSubmittableWorkspaceContextBase`.\r\n   * Used by the system to identify what type of content this workspace edits.\r\n   *\r\n   * @returns {string} Always returns NOTES_NOTE_ENTITY_TYPE (\"notes-note\")\r\n   */\r\n  getEntityType() {\r\n    return NOTES_NOTE_ENTITY_TYPE;\r\n  }\r\n\r\n  /**\r\n   * Gets the current note data as a single object.\r\n   *\r\n   * Required by `UmbSubmittableWorkspaceContextBase`.\r\n   * Returns all editable fields in a single object format.\r\n   *\r\n   * @returns {NoteWorkspaceData | undefined} The note data, or undefined if no note loaded\r\n   */\r\n  getData(): NoteWorkspaceData | undefined {\r\n    const unique = this.#unique.getValue();\r\n    if (!unique) return undefined;\r\n\r\n    return {\r\n      unique,\r\n      title: this.#title.getValue(),\r\n      content: this.#content.getValue(),\r\n      tags: this.#tags.getValue(),\r\n      parentUnique: this.#parentUnique.getValue() || null,\r\n    };\r\n  }\r\n\r\n  // ===========================================================================\r\n  // SETTERS - Used by UI components to update state\r\n  // These methods update the private state, triggering observable updates\r\n  // ===========================================================================\r\n\r\n  /**\r\n   * Sets the note title.\r\n   *\r\n   * @param {string} title - The new title\r\n   *\r\n   * @example\r\n   * // In a form component:\r\n   * context.setTitle(inputElement.value);\r\n   */\r\n  setTitle(title: string) {\r\n    this.#title.setValue(title);\r\n  }\r\n\r\n  /**\r\n   * Sets the note content (markdown).\r\n   *\r\n   * @param {string} content - The new markdown content\r\n   */\r\n  setContent(content: string) {\r\n    this.#content.setValue(content);\r\n  }\r\n\r\n  /**\r\n   * Replaces all tags with a new array.\r\n   *\r\n   * @param {string[]} tags - The new tags array\r\n   */\r\n  setTags(tags: string[]) {\r\n    this.#tags.setValue(tags);\r\n  }\r\n\r\n  /**\r\n   * Adds a single tag if it doesn't already exist.\r\n   *\r\n   * @param {string} tag - The tag to add\r\n   *\r\n   * @example\r\n   * context.addTag(\"important\");\r\n   * context.addTag(\"important\"); // No duplicate added\r\n   */\r\n  addTag(tag: string) {\r\n    const currentTags = this.#tags.getValue();\r\n    if (!currentTags.includes(tag)) {\r\n      this.#tags.setValue([...currentTags, tag]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Removes a tag from the list.\r\n   *\r\n   * @param {string} tag - The tag to remove\r\n   */\r\n  removeTag(tag: string) {\r\n    const currentTags = this.#tags.getValue();\r\n    this.#tags.setValue(currentTags.filter((t) => t !== tag));\r\n  }\r\n\r\n  // ===========================================================================\r\n  // CLEANUP\r\n  // ===========================================================================\r\n\r\n  /**\r\n   * Cleans up all state objects when the context is destroyed.\r\n   *\r\n   * Called automatically when the workspace closes.\r\n   * Important for memory management - state objects must be destroyed\r\n   * to prevent memory leaks from lingering subscriptions.\r\n   *\r\n   * @override\r\n   */\r\n  override destroy() {\r\n    // Destroy all state objects to clean up subscriptions\r\n    this.#unique.destroy();\r\n    this.#title.destroy();\r\n    this.#content.destroy();\r\n    this.#tags.destroy();\r\n    this.#icon.destroy();\r\n    this.#parentUnique.destroy();\r\n    this.#createdDate.destroy();\r\n    this.#modifiedDate.destroy();\r\n    this.#createdBy.destroy();\r\n    this.#modifiedBy.destroy();\r\n\r\n    // Call parent destroy for base class cleanup\r\n    super.destroy();\r\n  }\r\n}\r\n\r\n/**\r\n * Export the context class as `api` for Umbraco's extension loader.\r\n *\r\n * When the workspace manifest specifies `api: () => import(\"./note-workspace.context.js\")`,\r\n * Umbraco looks for the `api` export to instantiate the context.\r\n */\r\nexport { NoteWorkspaceContext as api };\r\n"],"names":["_workspaceContext","_NoteWorkspaceEditorElement_instances","observeData_fn","NoteWorkspaceEditorElement","UmbLitElement","__privateAdd","NOTE_WORKSPACE_CONTEXT","instance","__privateSet","__privateMethod","displayTitle","html","NOTES_NOTE_WORKSPACE_ALIAS","__privateGet","title","icon","isNew","css","__decorateClass","state","customElement","NoteWorkspaceContext","UmbSubmittableWorkspaceContextBase","host","_unique","_title","_content","_tags","_icon","_parentUnique","_createdDate","_modifiedDate","_createdBy","_modifiedBy","_notificationContext","UmbStringState","UmbArrayState","x","UMB_NOTIFICATION_CONTEXT","context","_component","info","unique","parentUnique","UmbWorkspaceIsNewRedirectController","data","NoteswikiService","error","newUnique","_a","eventContext","UMB_ACTION_EVENT_CONTEXT","event","UmbRequestReloadChildrenOfEntityEvent","NOTES_FOLDER_ENTITY_TYPE","NOTES_ROOT_ENTITY_TYPE","_b","NOTES_NOTE_ENTITY_TYPE","content","tags","tag","currentTags","t"],"mappings":"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"}