{"version":3,"file":"entry-point-D_OUv4hE.js","sources":["../../../Client/src/entry-point.ts"],"sourcesContent":["/**\r\n * @fileoverview Notes Wiki Entry Point\r\n *\r\n * The entry point is executed when the Notes Wiki extension loads.\r\n * It's responsible for one-time initialization tasks before the\r\n * extension's UI becomes available.\r\n *\r\n * Entry points in Umbraco implement two lifecycle methods:\r\n * 1. **onInit** - Called when the extension loads\r\n * 2. **onUnload** - Called when the extension unloads (cleanup)\r\n *\r\n * Common entry point tasks:\r\n * - Configure API clients with authentication\r\n * - Register global services\r\n * - Initialize third-party libraries\r\n * - Set up event listeners\r\n *\r\n * @example\r\n * // Entry point manifest in bundle.manifests.ts\r\n * {\r\n *   name: \"Notes Wiki Entry Point\",\r\n *   alias: \"Notes.EntryPoint\",\r\n *   type: \"backofficeEntryPoint\",\r\n *   js: () => import(\"./entry-point.js\"),\r\n * }\r\n *\r\n * Skills demonstrated: umbraco-entry-point, umbraco-openapi-client\r\n */\r\n\r\nimport type {\r\n  UmbEntryPointOnInit,\r\n  UmbEntryPointOnUnload,\r\n} from \"@umbraco-cms/backoffice/extension-api\";\r\nimport { UMB_AUTH_CONTEXT } from \"@umbraco-cms/backoffice/auth\";\r\nimport { client } from \"./api/client.gen.js\";\r\n\r\n/**\r\n * Initializes the Notes Wiki extension.\r\n *\r\n * This function runs once when the extension loads. It configures\r\n * the OpenAPI client with authentication from Umbraco's auth context,\r\n * enabling authenticated API requests.\r\n *\r\n * **Why is this needed?**\r\n *\r\n * The Notes Wiki API requires authentication. Umbraco's auth context\r\n * provides the bearer token and base URL configuration. We pass these\r\n * to the hey-api generated client so all API calls include proper\r\n * authentication headers.\r\n *\r\n * @param {UmbControllerHost} host - The controller host for context consumption\r\n * @param {UmbExtensionRegistry} _extensionRegistry - Extension registry (unused)\r\n *\r\n * @example\r\n * // This is called automatically by Umbraco when the extension loads.\r\n * // You don't need to call it manually.\r\n */\r\nexport const onInit: UmbEntryPointOnInit = (host, _extensionRegistry) => {\r\n  // Consume the auth context to get authentication configuration\r\n  host.consumeContext(UMB_AUTH_CONTEXT, (authContext) => {\r\n    if (!authContext) {\r\n      console.warn(\"Notes Wiki: Auth context not available\");\r\n      return;\r\n    }\r\n\r\n    // Get the OpenAPI configuration from Umbraco's auth context\r\n    // This includes: base URL, credentials mode, and token getter\r\n    const config = authContext.getOpenApiConfiguration();\r\n\r\n    // Configure the hey-api client with auth settings\r\n    // After this, all API calls will include the bearer token\r\n    client.setConfig({\r\n      baseUrl: config.base,\r\n      credentials: config.credentials,\r\n      auth: config.token,\r\n    });\r\n\r\n    console.log(\"Notes Wiki: API client configured\");\r\n  });\r\n};\r\n\r\n/**\r\n * Cleans up when the Notes Wiki extension unloads.\r\n *\r\n * This function runs when the extension is being removed or\r\n * the backoffice is shutting down. Use it to:\r\n * - Remove event listeners\r\n * - Cancel pending operations\r\n * - Clean up resources\r\n *\r\n * For this extension, no cleanup is required as the API client\r\n * configuration is automatically garbage collected.\r\n */\r\nexport const onUnload: UmbEntryPointOnUnload = () => {\r\n  // No cleanup required for this extension\r\n  // The API client configuration is garbage collected automatically\r\n};\r\n"],"names":["onInit","host","_extensionRegistry","UMB_AUTH_CONTEXT","authContext","config","client","onUnload"],"mappings":";;AAyDO,MAAMA,IAA8B,CAACC,GAAMC,MAAuB;AAEvE,EAAAD,EAAK,eAAeE,GAAkB,CAACC,MAAgB;AACrD,QAAI,CAACA,GAAa;AAChB,cAAQ,KAAK,wCAAwC;AACrD;AAAA,IACF;AAIA,UAAMC,IAASD,EAAY,wBAAA;AAI3B,IAAAE,EAAO,UAAU;AAAA,MACf,SAASD,EAAO;AAAA,MAChB,aAAaA,EAAO;AAAA,MACpB,MAAMA,EAAO;AAAA,IAAA,CACd,GAED,QAAQ,IAAI,mCAAmC;AAAA,EACjD,CAAC;AACH,GAcaE,IAAkC,MAAM;AAGrD;"}