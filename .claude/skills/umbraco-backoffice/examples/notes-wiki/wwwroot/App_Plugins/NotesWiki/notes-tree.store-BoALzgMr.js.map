{"version":3,"file":"notes-tree.store-BoALzgMr.js","sources":["../../../Client/src/tree/notes-tree.store.ts"],"sourcesContent":["/**\r\n * @fileoverview Notes Tree Store\r\n *\r\n * The tree store provides caching for tree items to avoid repeated API calls.\r\n * It extends Umbraco's `UmbUniqueTreeStore` which handles the caching logic.\r\n *\r\n * **Role in the Repository Pattern:**\r\n *\r\n * ```\r\n * Repository ─────> Data Source (API)\r\n *     │\r\n *     └─────> Store (Cache) <─── Items cached here\r\n * ```\r\n *\r\n * **Why Use a Store?**\r\n *\r\n * 1. **Performance**: Avoid redundant API calls when re-rendering the tree\r\n * 2. **Reactivity**: Provides observable state for UI updates\r\n * 3. **Consistency**: Single source of truth for tree data\r\n * 4. **Offline**: Cached data available even if API is slow\r\n *\r\n * **How It Works:**\r\n *\r\n * - Items are cached by their unique ID\r\n * - When the repository requests an item, it checks the store first\r\n * - If not cached, it fetches from the data source and updates the store\r\n * - UI components observe the store for reactive updates\r\n *\r\n * **Registration:**\r\n *\r\n * The store is registered via manifest and injected via context:\r\n *\r\n * ```typescript\r\n * // Store manifest\r\n * {\r\n *   type: \"treeStore\",\r\n *   alias: NOTES_TREE_STORE_ALIAS,\r\n *   api: () => import(\"./notes-tree.store.js\"),\r\n * }\r\n *\r\n * // Context token (defined in this file) enables DI\r\n * export const NOTES_TREE_STORE_CONTEXT = new UmbContextToken<NotesTreeStore>(\"NotesTreeStore\");\r\n * ```\r\n *\r\n * Skills demonstrated: umbraco-state-management, umbraco-repository-pattern, umbraco-context-api\r\n */\r\n\r\nimport { UmbContextToken } from \"@umbraco-cms/backoffice/context-api\";\r\nimport type { UmbControllerHost } from \"@umbraco-cms/backoffice/controller-api\";\r\nimport { UmbUniqueTreeStore } from \"@umbraco-cms/backoffice/tree\";\r\n\r\n/**\r\n * Store for caching Notes tree items.\r\n *\r\n * Extends `UmbUniqueTreeStore` which provides:\r\n * - Key-value caching by unique ID\r\n * - Observable state via RxJS\r\n * - Automatic cleanup on destroy\r\n *\r\n * **Note on Context Token:**\r\n *\r\n * The context token is defined in this file (not in constants.ts) to avoid\r\n * circular dependency issues. The store class needs to reference the token\r\n * in its constructor, and other files need to import the token to consume\r\n * the store via context.\r\n *\r\n * @example\r\n * // Consuming the store in a component\r\n * this.consumeContext(NOTES_TREE_STORE_CONTEXT, (store) => {\r\n *   // Store is now available\r\n *   store.getItems().subscribe((items) => {\r\n *     console.log(\"Cached items:\", items);\r\n *   });\r\n * });\r\n */\r\nexport class NotesTreeStore extends UmbUniqueTreeStore {\r\n  /**\r\n   * Creates a new tree store instance.\r\n   *\r\n   * @param {UmbControllerHost} host - The controller host for context provision\r\n   */\r\n  constructor(host: UmbControllerHost) {\r\n    super(host, NOTES_TREE_STORE_CONTEXT.toString());\r\n  }\r\n}\r\n\r\n/**\r\n * Export the store class as `api` for Umbraco's extension loader.\r\n *\r\n * When the manifest specifies `api: () => import(\"./notes-tree.store.js\")`,\r\n * Umbraco looks for the `api` export to instantiate the store.\r\n */\r\nexport { NotesTreeStore as api };\r\n\r\n/**\r\n * Context token for dependency injection of the tree store.\r\n *\r\n * Use this token with `consumeContext` to get the store instance:\r\n *\r\n * ```typescript\r\n * this.consumeContext(NOTES_TREE_STORE_CONTEXT, (store) => {\r\n *   // Use store here\r\n * });\r\n * ```\r\n *\r\n * **Why a Context Token?**\r\n *\r\n * Umbraco uses a context-based dependency injection system.\r\n * Context tokens identify services that can be provided by parent\r\n * components and consumed by child components. This enables:\r\n *\r\n * - Loose coupling between components\r\n * - Easy testing with mock implementations\r\n * - Scoped instances per component tree\r\n *\r\n * @type {UmbContextToken<NotesTreeStore>}\r\n */\r\nexport const NOTES_TREE_STORE_CONTEXT = new UmbContextToken<NotesTreeStore>(\r\n  \"NotesTreeStore\"\r\n);\r\n"],"names":["NotesTreeStore","UmbUniqueTreeStore","host","NOTES_TREE_STORE_CONTEXT","UmbContextToken"],"mappings":";;AA2EO,MAAMA,UAAuBC,EAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMrD,YAAYC,GAAyB;AACnC,UAAMA,GAAMC,EAAyB,UAAU;AAAA,EACjD;AACF;AAiCO,MAAMA,IAA2B,IAAIC;AAAA,EAC1C;AACF;"}