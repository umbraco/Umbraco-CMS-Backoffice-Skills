{"version":3,"file":"note-workspace.context-token-DNUQtk0q.js","sources":["../../../Client/src/workspace/note/note-workspace.context-token.ts"],"sourcesContent":["/**\r\n * @fileoverview Note Workspace Context Token\r\n *\r\n * Defines the context token for dependency injection of the note workspace context.\r\n * This token enables components to consume the workspace context and access note data.\r\n *\r\n * **Why Use a Context Token?**\r\n *\r\n * Umbraco's backoffice uses a context-based dependency injection system.\r\n * Instead of importing singletons directly, components \"consume\" contexts\r\n * provided by parent components. This enables:\r\n *\r\n * - **Scoped instances**: Each workspace has its own context\r\n * - **Testability**: Easy to mock for unit tests\r\n * - **Loose coupling**: Components don't need direct imports\r\n *\r\n * **CRITICAL: The \"UmbWorkspaceContext\" Alias**\r\n *\r\n * The first argument to `UmbContextToken` MUST be `\"UmbWorkspaceContext\"` to match\r\n * Umbraco's built-in workspace context token. This is essential because:\r\n *\r\n * 1. **Workspace conditions**: The `workspaceAlias` condition uses this alias\r\n *    to find the active workspace and check its alias\r\n * 2. **Workspace views**: Views with conditions like `workspaceAlias === \"...\"`\r\n *    only appear when they can find a context with this exact alias\r\n * 3. **Workspace actions**: The Save button and other actions rely on this\r\n *\r\n * **Type Parameters:**\r\n *\r\n * ```typescript\r\n * UmbContextToken<BaseType, SpecificType>\r\n * ```\r\n *\r\n * - `UmbWorkspaceContext` - Base type (for compatibility)\r\n * - `NoteWorkspaceContext` - Specific type (for type safety)\r\n *\r\n * The discriminator function (third argument) narrows the type at runtime.\r\n *\r\n * @example\r\n * // In a component that needs the note context:\r\n * import { NOTE_WORKSPACE_CONTEXT } from \"./note-workspace.context-token.js\";\r\n *\r\n * class MyComponent extends UmbLitElement {\r\n *   constructor() {\r\n *     super();\r\n *     this.consumeContext(NOTE_WORKSPACE_CONTEXT, (context) => {\r\n *       // TypeScript knows this is NoteWorkspaceContext\r\n *       context.title.subscribe((title) => {\r\n *         console.log(\"Note title:\", title);\r\n *       });\r\n *     });\r\n *   }\r\n * }\r\n *\r\n * Skills demonstrated: umbraco-context-api, umbraco-workspace\r\n */\r\n\r\nimport { UmbContextToken } from \"@umbraco-cms/backoffice/context-api\";\r\nimport type { UmbWorkspaceContext } from \"@umbraco-cms/backoffice/workspace\";\r\nimport type { NoteWorkspaceContext } from \"./note-workspace.context.js\";\r\nimport { NOTES_NOTE_ENTITY_TYPE } from \"../../constants.js\";\r\n\r\n/**\r\n * Context token for consuming the note workspace context.\r\n *\r\n * **Usage:**\r\n *\r\n * ```typescript\r\n * this.consumeContext(NOTE_WORKSPACE_CONTEXT, (context) => {\r\n *   // Access note data and methods\r\n *   context.title.subscribe((title) => this._title = title);\r\n *   context.setTitle(\"New Title\");\r\n * });\r\n * ```\r\n *\r\n * **Discriminator Function:**\r\n *\r\n * The third argument is a type guard that distinguishes this workspace from others.\r\n * When multiple workspaces are in the component tree, the discriminator ensures\r\n * we get the correct one (a note workspace, not a folder workspace).\r\n *\r\n * @type {UmbContextToken<UmbWorkspaceContext, NoteWorkspaceContext>}\r\n */\r\nexport const NOTE_WORKSPACE_CONTEXT = new UmbContextToken<\r\n  UmbWorkspaceContext,\r\n  NoteWorkspaceContext\r\n>(\r\n  // CRITICAL: Must be \"UmbWorkspaceContext\" for workspace conditions to work\r\n  // This matches Umbraco's UMB_WORKSPACE_CONTEXT token alias\r\n  \"UmbWorkspaceContext\",\r\n\r\n  // Default value (undefined means no default - will wait for context)\r\n  undefined,\r\n\r\n  // Discriminator: Type guard to identify this specific workspace type\r\n  // Returns true only if the context is for a note entity\r\n  (context): context is NoteWorkspaceContext =>\r\n    context.getEntityType?.() === NOTES_NOTE_ENTITY_TYPE\r\n);\r\n"],"names":["NOTE_WORKSPACE_CONTEXT","UmbContextToken","context","_a","NOTES_NOTE_ENTITY_TYPE"],"mappings":";;AAmFO,MAAMA,IAAyB,IAAIC;AAAA;AAAA;AAAA,EAMxC;AAAA;AAAA,EAGA;AAAA;AAAA;AAAA,EAIA,CAACC,MAAA;;AACC,aAAAC,IAAAD,EAAQ,kBAAR,gBAAAC,EAAA,KAAAD,QAA8BE;AAAA;AAClC;"}