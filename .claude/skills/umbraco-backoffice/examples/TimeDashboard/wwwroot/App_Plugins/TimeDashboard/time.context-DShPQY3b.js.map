{"version":3,"file":"time.context-DShPQY3b.js","sources":["../../../Client/src/api/sdk.gen.ts","../../../Client/src/repository/sources/time.datasource.ts","../../../Client/src/repository/time.repository.ts","../../../Client/src/contexts/time.context.ts"],"sourcesContent":["// This file is auto-generated by @hey-api/openapi-ts\n\nimport type { Client, Options as Options2, TDataShape } from './client';\nimport { client } from './client.gen';\nimport type { GetChildrenData, GetChildrenErrors, GetChildrenResponses, GetDateData, GetDateErrors, GetDateResponses, GetRootData, GetRootErrors, GetRootResponses, GetTimeData, GetTimeErrors, GetTimeResponses } from './types.gen';\n\nexport type Options<TData extends TDataShape = TDataShape, ThrowOnError extends boolean = boolean> = Options2<TData, ThrowOnError> & {\n    /**\n     * You can provide a client instance returned by `createClient()` instead of\n     * individual options. This might be also useful if you want to implement a\n     * custom client.\n     */\n    client?: Client;\n    /**\n     * You can pass arbitrary values through the `meta` object. This can be\n     * used to access values that aren't defined as part of the SDK function.\n     */\n    meta?: Record<string, unknown>;\n};\n\nexport class TimedashboardService {\n    public static getDate<ThrowOnError extends boolean = false>(options?: Options<GetDateData, ThrowOnError>) {\n        return (options?.client ?? client).get<GetDateResponses, GetDateErrors, ThrowOnError>({\n            security: [\n                {\n                    scheme: 'bearer',\n                    type: 'http'\n                }\n            ],\n            url: '/umbraco/timedashboard/api/v1/time/date',\n            ...options\n        });\n    }\n    \n    public static getTime<ThrowOnError extends boolean = false>(options?: Options<GetTimeData, ThrowOnError>) {\n        return (options?.client ?? client).get<GetTimeResponses, GetTimeErrors, ThrowOnError>({\n            security: [\n                {\n                    scheme: 'bearer',\n                    type: 'http'\n                }\n            ],\n            url: '/umbraco/timedashboard/api/v1/time/time',\n            ...options\n        });\n    }\n    \n    public static getChildren<ThrowOnError extends boolean = false>(options?: Options<GetChildrenData, ThrowOnError>) {\n        return (options?.client ?? client).get<GetChildrenResponses, GetChildrenErrors, ThrowOnError>({\n            security: [\n                {\n                    scheme: 'bearer',\n                    type: 'http'\n                }\n            ],\n            url: '/umbraco/timedashboard/api/v1/tree',\n            ...options\n        });\n    }\n    \n    public static getRoot<ThrowOnError extends boolean = false>(options?: Options<GetRootData, ThrowOnError>) {\n        return (options?.client ?? client).get<GetRootResponses, GetRootErrors, ThrowOnError>({\n            security: [\n                {\n                    scheme: 'bearer',\n                    type: 'http'\n                }\n            ],\n            url: '/umbraco/timedashboard/api/v1/tree/root',\n            ...options\n        });\n    }\n}\n","import { UmbDataSourceResponse } from \"@umbraco-cms/backoffice/repository\";\r\nimport { TimedashboardService } from \"../../api/index.js\";\r\n\r\n\r\nexport interface TimeDataSource {\r\n    getTime(): Promise<UmbDataSourceResponse<string>>;\r\n    getDate(): Promise<UmbDataSourceResponse<string>>;\r\n}\r\n\r\nexport class TimeManagementDataSource implements TimeDataSource {\r\n\r\n    async getTime(): Promise<UmbDataSourceResponse<string>> {\r\n        const { data, error } = await TimedashboardService.getTime();\r\n        if (error) {\r\n            const err = new Error(String(error));\r\n            return { error: err };\r\n        }\r\n        return { data: data as string };\r\n    }\r\n\r\n    async getDate(): Promise<UmbDataSourceResponse<string>> {\r\n        const { data, error } = await TimedashboardService.getDate();\r\n        if (error) {\r\n            const err = new Error(String(error));\r\n            return { error: err };\r\n        }\r\n        return { data: data as string };\r\n    }\r\n}\r\n","import { UmbControllerBase } from \"@umbraco-cms/backoffice/class-api\";\r\nimport { UmbControllerHost } from \"@umbraco-cms/backoffice/controller-api\";\r\nimport { TimeManagementDataSource } from \"./sources/time.datasource.js\";\r\n\r\nexport class TimeManagementRepository extends UmbControllerBase {\r\n    #timeDataSource: TimeManagementDataSource;\r\n\r\n    constructor(host: UmbControllerHost) {\r\n        super(host);\r\n        this.#timeDataSource = new TimeManagementDataSource();\r\n\r\n        console.log('repository constructor');\r\n    }\r\n\r\n    async getTime() {\r\n        return this.#timeDataSource.getTime();\r\n    }\r\n\r\n    async getDate() {\r\n        return this.#timeDataSource.getDate();\r\n    }\r\n}\r\n","import { UmbControllerBase } from \"@umbraco-cms/backoffice/class-api\";\r\nimport { UmbControllerHost } from \"@umbraco-cms/backoffice/controller-api\";\r\nimport { UmbContextToken } from \"@umbraco-cms/backoffice/context-api\";\r\nimport { UmbBooleanState, UmbStringState } from \"@umbraco-cms/backoffice/observable-api\";\r\n\r\nimport { TimeManagementRepository } from \"../repository/time.repository.js\";\r\n\r\nexport class TimeManagementContext extends UmbControllerBase {\r\n\r\n    #repository: TimeManagementRepository;\r\n\r\n    #time = new UmbStringState(\"unknown\");\r\n    public readonly time = this.#time.asObservable();\r\n\r\n    #date = new UmbStringState(\"unknown\");\r\n    public readonly date = this.#date.asObservable();\r\n\r\n    constructor(host: UmbControllerHost) {\r\n        super(host);\r\n\r\n        this.provideContext(TIME_MANAGEMENT_CONTEXT_TOKEN, this);\r\n        this.#repository = new TimeManagementRepository(this);\r\n    }\r\n\r\n    async getTime() {\r\n        const {data} = await this.#repository.getTime();\r\n\r\n        if (data) {\r\n            this.#time.setValue(data);\r\n        }\r\n    }\r\n\r\n    async getDate() {\r\n        const {data} = await this.#repository.getDate();\r\n\r\n        if (data) {\r\n            this.#date.setValue(data);\r\n        }\r\n    }\r\n\r\n    async getDateAndTime() {\r\n        this.getTime();\r\n        this.getDate();\r\n    }\r\n\r\n    #intervalId: number | null = null;\r\n\r\n    #polling = new UmbBooleanState(false);\r\n    polling = this.#polling.asObservable();\r\n\r\n    togglePolling() {\r\n        const isEnabled = !this.#polling.getValue();\r\n        this.#polling.setValue(isEnabled);\r\n\r\n        if (isEnabled) {\r\n            this.#intervalId = setInterval(() => {\r\n                this.getDateAndTime();\r\n            }, 750) as unknown as number;\r\n            return;\r\n        }\r\n\r\n        clearInterval(this.#intervalId as number);\r\n    }\r\n\r\n}\r\n\r\nexport default TimeManagementContext;\r\n\r\nexport const TIME_MANAGEMENT_CONTEXT_TOKEN =\r\n    new UmbContextToken<TimeManagementContext>(TimeManagementContext.name);\r\n\r\nexport const api = TimeManagementContext;\r\n"],"names":["TimedashboardService","options","client","TimeManagementDataSource","data","error","TimeManagementRepository","UmbControllerBase","#timeDataSource","host","TimeManagementContext","#time","UmbStringState","#date","#intervalId","#polling","UmbBooleanState","TIME_MANAGEMENT_CONTEXT_TOKEN","#repository","isEnabled","UmbContextToken","api"],"mappings":"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"}